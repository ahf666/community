{"ast":null,"code":"import axios from 'axios';\nexport default {\n  created() {\n    this.load();\n  },\n  methods: {\n    freshHouse() {\n      this.houseDetails.building = 0;\n      this.houseDetails.cell = 0;\n      this.houseDetails.floor = 0;\n      this.houseDetails.doorplate = '';\n    },\n    freshStop() {\n      this.stopDetails.place = '';\n    },\n    buy(index, rows) {\n      if (rows[index].status === 1) {\n        this.$message(\"已缴费，无需缴费\");\n        return;\n      } else {\n        let id = rows[index].id;\n        axios({\n          url: `/api/user/fee/${id}`,\n          method: 'post',\n          headers: {\n            token: this.$store.state.user.token\n          }\n        }).then(res => {\n          // 成功回调函数\n          if (res.data.code == 1) {\n            // 成功\n            this.$message(\"缴费成功\");\n            this.load();\n          } else {\n            console.log(res.data.msg);\n          }\n        });\n      }\n    },\n    details(index, rows) {\n      console.log(\"查看详情:\", index, rows);\n      if (rows[index].houseId === 0) {\n        // 是车位费\n        this.freshHouse();\n        axios({\n          url: '/api/user/fee/details/stop',\n          method: 'get',\n          params: {\n            stopId: rows[index].stopId\n          },\n          headers: {\n            token: this.$store.state.user.token\n          }\n        }).then(res => {\n          // 成功回调函数再发请求\n          if (res.data.code == 1) {\n            // 成功\n            this.stopDetails = res.data.data;\n          } else {\n            console.log(res.data.msg);\n          }\n        });\n      } else {\n        // 是物业费\n        this.freshStop();\n        axios({\n          url: '/api/user/fee/details/house',\n          method: 'get',\n          params: {\n            houseId: rows[index].houseId\n          },\n          headers: {\n            token: this.$store.state.user.token\n          }\n        }).then(res => {\n          // 成功回调函数再发请求\n          if (res.data.code == 1) {\n            // 成功\n            this.houseDetails = res.data.data;\n          } else {\n            console.log(res.data.msg);\n          }\n        });\n      }\n    },\n    load() {\n      this.name = this.$store.state.user.name;\n      this.userId = this.$store.state.user.id;\n      console.log('发请求前页数与大小', this.page, this.pageSize);\n      var feePageDTO = {\n        page: this.page,\n        pageSize: this.pageSize,\n        userId: this.userId\n      };\n      axios({\n        url: '/api/user/fee/page',\n        method: 'get',\n        params: feePageDTO,\n        headers: {\n          token: this.$store.state.user.token\n        }\n      }).then(res => {\n        // 成功回调函数再发请求\n        if (res.data.code == 1) {\n          // 成功\n          console.log(\"这是数据\", res.data.data);\n          this.total = res.data.data.total;\n          this.vo = res.data.data.records;\n          console.log(\"这是f数据\", this.total, this.vo);\n        } else {\n          console.log(res.data.msg);\n        }\n      });\n    },\n    handleSizeChange(val) {\n      this.pageSize = val;\n      // console.log(`每页 ${val} 条`);\n      console.log('每页', this.pageSize);\n      this.load();\n    },\n    handleCurrentChange(val) {\n      this.page = val;\n      console.log('页数', this.page);\n      // console.log(`当前页: ${val}`);\n      this.load();\n    },\n    handleClose(done) {\n      this.$confirm('确认关闭？').then(_ => {\n        done();\n      }).catch(_ => {});\n    },\n    tableRowClassName({\n      row,\n      rowIndex\n    }) {\n      if (row.status === 0) {\n        return 'warning-row';\n      } else if (row.status === 1) {\n        return 'success-row';\n      }\n      return '';\n    }\n  },\n  data() {\n    return {\n      page: 1,\n      pageSize: 10,\n      userId: 0,\n      name: '',\n      total: 0,\n      dialogVisible: false,\n      houseDetails: {\n        building: 0,\n        cell: 0,\n        floor: 0,\n        doorplate: ''\n      },\n      stopDetails: {\n        place: ''\n      },\n      vo: []\n    };\n  }\n};","map":{"version":3,"names":["axios","created","load","methods","freshHouse","houseDetails","building","cell","floor","doorplate","freshStop","stopDetails","place","buy","index","rows","status","$message","id","url","method","headers","token","$store","state","user","then","res","data","code","console","log","msg","details","houseId","params","stopId","name","userId","page","pageSize","feePageDTO","total","vo","records","handleSizeChange","val","handleCurrentChange","handleClose","done","$confirm","_","catch","tableRowClassName","row","rowIndex","dialogVisible"],"sources":["src/views/user/fee/fee.vue"],"sourcesContent":["<template>\r\n    <div>  \r\n        <el-table\r\n        class=\"table\"\r\n        :data=\"this.vo\"\r\n        style=\"width: 100%\"\r\n        :row-class-name=\"tableRowClassName\"\r\n        max-height=\"700px\">\r\n  \r\n        <el-table-column\r\n          prop=\"typeId\"\r\n          label=\"缴费类型\"\r\n          width=\"350\">\r\n          <template slot-scope=\"scope\">  \r\n            <span v-if=\"scope.row.typeId === 1\">电费</span>  \r\n            <span v-else-if=\"scope.row.typeId === 2\">水费</span>\r\n            <span v-else-if=\"scope.row.typeId === 3\">临时停车费</span> \r\n            <span v-else>租借车位费</span>\r\n            \r\n          </template> \r\n        </el-table-column>\r\n  \r\n        <el-table-column\r\n          prop=\"amount\"\r\n          label=\"费用\"\r\n          width=\"333\">\r\n        </el-table-column>\r\n      \r\n        <el-table-column\r\n          prop=\"status\"\r\n          label=\"状态\"\r\n          width=\"320\">\r\n          <template slot-scope=\"scope\">  \r\n            <span v-if=\"scope.row.status === 0\">未缴费</span>  \r\n            <span v-else>已缴费</span>  \r\n          </template> \r\n        </el-table-column>\r\n    \r\n        <el-table-column\r\n          label=\"操作\"\r\n          width=\"320\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n              @click.native.prevent=\"buy(scope.$index, vo)\"\r\n              type=\"text\"\r\n              size=\"small\">\r\n              缴费\r\n            </el-button>\r\n            <el-button\r\n              @click.native.prevent=\"details(scope.$index, vo)\"\r\n              @click=\"dialogVisible = true\"\r\n              type=\"text\"\r\n              size=\"small\">\r\n              详情\r\n            </el-button>\r\n            <el-dialog\r\n              title=\"详情\"\r\n              :visible.sync=\"dialogVisible\"\r\n              width=\"30%\"\r\n              :before-close=\"handleClose\">   \r\n              <!-- <h1 v-if=\"houseDetails.building != 0\">楼栋号:{{houseDetails.building}}</h1>\r\n              <h1 v-if=\"houseDetails.cell != 0\">单元号:{{houseDetails.cell}}</h1>\r\n              <h1 v-if=\"houseDetails.floor != 0\">楼层号:{{houseDetails.floor}}</h1>\r\n              <h1 v-if=\"houseDetails.doorplate != ''\">门牌号:{{houseDetails.doorplate}}</h1>\r\n              <h1 v-if=\"stopDetails.place != ''\">车位信息:{{stopDetails.place}}</h1> -->\r\n           \r\n\r\n              <el-descriptions  title=\"房屋信息\" :column=\"1\" border>   \r\n          <el-descriptions-item v-if=\"houseDetails.building != 0\">\r\n            <template slot=\"label\">\r\n              <i class=\"el-icon-discount\"></i>\r\n              楼栋号\r\n            </template>\r\n            {{ houseDetails.building }}栋\r\n          </el-descriptions-item>\r\n               \r\n          <el-descriptions-item v-if=\"houseDetails.cell != 0\">\r\n            <template slot=\"label\">\r\n              <i class=\"el-icon-receiving\"></i>\r\n              单元号\r\n            </template>\r\n            {{ houseDetails.cell }}单元\r\n          </el-descriptions-item>\r\n\r\n          <el-descriptions-item v-if=\"houseDetails.floor != 0\">\r\n            <template slot=\"label\">\r\n              <i class=\"el-icon-coin\"></i>\r\n              楼层\r\n            </template>\r\n            {{ houseDetails.floor }}楼\r\n          </el-descriptions-item>\r\n\r\n          <el-descriptions-item v-if=\"houseDetails.doorplate != 0\">\r\n            <template slot=\"label\">\r\n              <i class=\"el-icon-postcard\"></i>\r\n              门牌号\r\n            </template>\r\n            {{ houseDetails.doorplate }}\r\n          </el-descriptions-item>\r\n\r\n          <el-descriptions-item v-if=\"stopDetails.place != ''\">\r\n            <template slot=\"label\">\r\n              <i class=\"el-icon-postcard\"></i>\r\n              车位信息\r\n            </template>\r\n            {{ stopDetails.place }}\r\n          </el-descriptions-item>\r\n        </el-descriptions>\r\n\r\n              <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"dialogVisible = false\">确 定</el-button>\r\n              </span>\r\n            </el-dialog>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <el-pagination\r\n          class=\"page\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :page-sizes=\"[5, 10, 15, 20]\"\r\n          :page-size=this.pageSize\r\n          :current-page=this.page\r\n          layout=\"total, sizes, prev, pager, next\"\r\n          :total= this.total>\r\n        </el-pagination>\r\n      \r\n    </div>\r\n    \r\n    </template>\r\n    \r\n    <script>\r\n    import axios from 'axios'\r\n      export default {\r\n    \r\n        created(){\r\n          this.load();\r\n        },\r\n    \r\n        methods: {\r\n          freshHouse(){\r\n            this.houseDetails.building = 0;\r\n            this.houseDetails.cell = 0;\r\n            this.houseDetails.floor = 0;\r\n            this.houseDetails.doorplate = '';\r\n          },\r\n          freshStop(){\r\n            this.stopDetails.place = '';\r\n          },\r\n          buy(index, rows){\r\n            if(rows[index].status === 1){\r\n                this.$message(\"已缴费，无需缴费\")\r\n                return\r\n            }else{\r\n                let id = rows[index].id;\r\n                axios({\r\n                    url: `/api/user/fee/${id}`,\r\n                    method: 'post',\r\n                    headers: {\r\n                        token: this.$store.state.user.token\r\n                    }\r\n                    }).then(res => { // 成功回调函数\r\n                    if(res.data.code == 1){ // 成功\r\n                        this.$message(\"缴费成功\")\r\n                        this.load();\r\n                    }else{\r\n                        console.log(res.data.msg)\r\n                    }\r\n                })\r\n            }\r\n\r\n          },\r\n          details(index, rows) {\r\n            console.log(\"查看详情:\", index, rows)\r\n            if(rows[index].houseId === 0){ // 是车位费\r\n              this.freshHouse();\r\n              axios({\r\n                url: '/api/user/fee/details/stop',\r\n                method: 'get',\r\n                params: {\r\n                  stopId: rows[index].stopId\r\n                },\r\n                headers: {\r\n                  token: this.$store.state.user.token\r\n                }\r\n                }).then(res => { // 成功回调函数再发请求\r\n                  if(res.data.code == 1){ // 成功\r\n                    this.stopDetails = res.data.data;\r\n                  }else{\r\n                    console.log(res.data.msg)\r\n                  }\r\n              })\r\n            }else{ // 是物业费\r\n              this.freshStop();\r\n              axios({\r\n                url: '/api/user/fee/details/house',\r\n                method: 'get',\r\n                params: {\r\n                  houseId: rows[index].houseId\r\n                },\r\n                headers: {\r\n                  token: this.$store.state.user.token\r\n                }\r\n                }).then(res => { // 成功回调函数再发请求\r\n                  if(res.data.code == 1){ // 成功\r\n                    this.houseDetails = res.data.data;\r\n                  }else{\r\n                    console.log(res.data.msg)\r\n                  }\r\n              })\r\n            }\r\n          },\r\n    \r\n          load(){\r\n            this.name = this.$store.state.user.name;\r\n            this.userId = this.$store.state.user.id; \r\n            console.log('发请求前页数与大小', this.page, this.pageSize)\r\n            var feePageDTO = {\r\n              page: this.page,\r\n              pageSize: this.pageSize,\r\n              userId: this.userId\r\n            }\r\n            axios({\r\n            url: '/api/user/fee/page',\r\n            method: 'get',\r\n            params: feePageDTO,\r\n            headers: {\r\n              token: this.$store.state.user.token\r\n            }\r\n            }).then(res => { // 成功回调函数再发请求\r\n              if(res.data.code == 1){ // 成功\r\n                console.log(\"这是数据\", res.data.data)\r\n                this.total = res.data.data.total;\r\n                this.vo = res.data.data.records;\r\n                console.log(\"这是f数据\", this.total, this.vo)\r\n              }else{\r\n                console.log(res.data.msg)\r\n              }\r\n            })\r\n          },\r\n    \r\n          handleSizeChange(val) {\r\n            this.pageSize = val;\r\n            // console.log(`每页 ${val} 条`);\r\n            console.log('每页', this.pageSize);\r\n            this.load();\r\n          },\r\n    \r\n          handleCurrentChange(val) {\r\n            this.page = val;\r\n            console.log('页数', this.page);\r\n            // console.log(`当前页: ${val}`);\r\n            this.load();\r\n          },\r\n    \r\n          handleClose(done) {\r\n            this.$confirm('确认关闭？')\r\n              .then(_ => {\r\n                done();\r\n              })\r\n              .catch(_ => {});\r\n          },\r\n          tableRowClassName({row, rowIndex}) {\r\n            if (row.status === 0) {\r\n              return 'warning-row';\r\n            } else if (row.status === 1) {\r\n              return 'success-row';\r\n            }\r\n            return '';\r\n          }\r\n        },\r\n    \r\n    \r\n        data() {\r\n          return {\r\n            page : 1,\r\n            pageSize: 10,\r\n            userId: 0,\r\n            name: '',\r\n            total: 0,\r\n            dialogVisible: false,\r\n\r\n\r\n            houseDetails:{\r\n              building: 0,\r\n              cell: 0,\r\n              floor: 0,\r\n              doorplate: ''\r\n            },\r\n\r\n            stopDetails:{\r\n                place: ''\r\n            },\r\n            vo: [],\r\n          }\r\n        }\r\n      }\r\n    </script>\r\n    \r\n    <style>\r\n      .search {\r\n        display: flex;\r\n        flex-wrap: wrap\r\n      }\r\n      .table{\r\n        padding-top: 10px;\r\n        margin-bottom: 10px;\r\n        margin-top: 10px;\r\n        min-height: 700px;\r\n        max-height: 700px\r\n      }\r\n      .seTag{\r\n        /*垂直居中 */\r\n        vertical-align: middle;\r\n        /*水平居中*/\r\n        text-align: center;\r\n      }\r\n      .tag{\r\n        font-size: 18px;\r\n        padding-top: 18px;\r\n        padding-left: 20px;\r\n        padding-right: 5px;\r\n      }\r\n      .seBT{\r\n        margin-top: 10px;\r\n      }\r\n      .el-table .cell {  \r\n        text-align: center;  \r\n      }\r\n      .el-dialog{\r\n        /* background: transparent;\r\n        background-image: url('@/assets/login.png');\r\n        background-size: 100% 100%; */\r\n        background-color: #F0F9EB;\r\n        border-radius: 20px;\r\n      }\r\n      .el-table .warning-row {\r\n        background: oldlace;\r\n      }\r\n  \r\n      .el-table .success-row {\r\n       background: #f0f9eb;\r\n      }\r\n      .el-descriptions{\r\n        height: 200px;\r\n        /* margin-top: 30px; */\r\n        margin-left: 50px;\r\n        margin-right: 50px;\r\n        /* padding-top: 30px; */\r\n        padding-left: 50px;\r\n        padding-right: 50px;\r\n        padding-bottom: 50px;\r\n        background-color:#F0F9EB;\r\n        border-radius: 20px;\r\n        text-align: center;\r\n    }\r\n    </style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}